title: Word进阶之道：公式的输入
date: 2014-03-30 14:00
category: 瞎鼓捣
tags: word, office
author: ZhouHao
slug: advanced_word_equation

*作者：ZhouHao 出处：http://www.zhouhao.me 欢迎转载，但也请保留这段声明。谢谢！*

Markdown不能提供足够的排版功能，LaTeX又不适合日常的写作。其实，习惯使用Word的人还是用Word来写作更加得心应手。但是Word有很多地方让人头痛，其中最烦恼的，莫过于在Word中插入公式了。
<!-- PELICAN_END_SUMMARY -->

## 线性格式公式的插入

### 1. 符合公式的输入

在Word中插入公式一直是一件十分让人头痛的工作。一般而言有两种选择，一是左键选择，二是用内置的LaTeX编辑器编辑。但是，从07版开始，Word公式编辑器就有了很大的改变，主要是支持了很多简单的标记语言，实现了线性格式的公式输入(Linear Format)。

下面就介绍一些简单的例子。

首先，`alt+=`打开公式编辑器，键入

	\sum <space> _(k=1)^n <space>

其中，`<space>`表示一个空格键。

> 空格键表示激活一个公式。按下空格后，前面的公式即可显示出来。


即上面的内容表示输入\sum后输入一个空格，然后再输入_(k=1)^n，再输入一个空格，显示结果如下：

$$\sum_{k=1}^{n}$$

下面列举更多的线性格式公式的例子：

<img src="/static/img/word_equations.png" title="线性格式公式举例" width="600" />

其中，最后两个公式用到了@和&符号。

> **@**表示换行，**&**表示对齐。

举例说明，在公式编辑器中输入下面这些内容：
	
	\eqarray(\sum_(k=1)^n <space> (1/k(k+1)) <right-arrow> &=\sum_(k=1)^n <space> (1/k-1/(k+1)) <right-arrow> @&=1-1/(n+1)@&=n/(n+1)) <space>
	
其中，<right-arrow>表示右移键。

上面的代码中，\eqarray表示其后括号中的内容为一个等式序列（就是一系列的等式）。第一个等式为\sum_(k=1)^n <space> (1/k(k+1))，显示为一个从1到n的累加。之后用右移键将光标移出累加符号的作用域。然后&表示对齐位，即所有的&都将对齐。同样地，输入第二个等式，然后输入右移键（因为第二个等式中也有累加运算符）。然后输入@，表示换行，&表示对齐位，将与之前的&位对齐。此后，可以同样表示，最后的结果为：

<img src="/static/img/complex-equation.png" title="复杂公式举例" width="600" />

**可以思考一下：如果上式中的@&不同时使用,而是单独使用@和&，会出现什么情况。**

### 2. 数学符号的输入

符号的激活也是靠空格键(space)，例如在公式编辑器中输入\alpha后点击空格键，就能显示出希腊字符α。

下面给出常见的字符，及其对应的线性格式：

<img src="/static/img/word_characters.png" title="复杂公式举例" width="600" />

可以发现所有的希腊字母的线性格式都是\加上该符号读音。特别的，第一个字母为小写，即为小写字符，第一个字母为大写即为大写字符（如delta）。

### 3. 更多的符号与公式

Microsoft Office 2007及以上版本支持的线性格式数学公式，就是可以用转义字符\和相应的关键词来表示一个符号或者公式，如\alpha就是用转义字符\和关键词alpha来表示α字母。

更多的规则可以参考文档[UTN28-PlainTextMath-v2.pdf](http://www.unicode.org/notes/tn28/UTN28-PlainTextMath-v2.pdf)，里面的附表2有更详细的符号与其线性格式的对应关系。表中第一列为关键词，在Word的内置公式编辑器中输入转义字符`\`加关键词(keyword，在附表2中第一列)，点击空格即可看到其对应的字符（附表2的第二列）。